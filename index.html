<html>
  <!--Will Ginsberg 11/27/16-->
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="https://cdn.mxpnl.com/libs/mixpanel-platform/css/reset.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.mxpnl.com/libs/mixpanel-platform/build/mixpanel-platform.v0.latest.min.css">
    <script src="https://cdn.mxpnl.com/libs/mixpanel-platform/build/mixpanel-platform.v0.latest.min.js"></script>
    <!--<script src="https://code.highcharts.com/highcharts.js"></script>-->
    <!--<script src="https://code.highcharts.com/modules/exporting.js"></script>-->
    <!--<script src="https://code.highcharts.com/modules/offline-exporting.js"></script>-->

    
    <!--<script src="https://code.highcharts.com/modules/offline-exporting.js"></script>-->
    
    <style>
      #header_div{
        font-size: 30px;
        font-weight: bold;
        color: #585858;
      }
      .dropdown_label{
        float: right;
        margin-left: 11px;
        margin-right: 11px;
        margin-top: 7px;
        color: #585858;
        font-size: 15px;
        font-weight:bold;
      }
      .dropdown_label_left{
        float: left;
        margin-left: 11px;
        margin-right: 11px;
        margin-top: 7px;
        color: #585858;
        font-size: 15px;
        font-weight:bold;
      }
      .checkbox {
        float: left;
      	width: 40px;
      	height: 10px;
      	background: #555;
      	margin: 20px 20px;
      	position: relative;
      	border-radius: 3px;
      }
      .checkbox label {
        float:left;
      	display: block;
      	width: 16px;
      	height: 16px;
      	border-radius: 50%;
      	transition: all .5s ease;
      	cursor: pointer;
      	position: absolute;
      	top: -3px;
      	left: -3px;
      	background: #ccc;
      }
      .checkbox input[type=checkbox]:checked + label {
	        left: 27px;
      }
    </style>
  </head>
  <body class="mixpanel-platform-body">
  	<div class="mixpanel-platform-section">
  		<div id="header_div" style="display:flex;justify-content:center;align-items:center;width:100%;">Retention Curve</div>
  		<div style="clear: both;"></div>
  	</div>
  	<div class="mixpanel-platform-section">
      <div id="dateSelect" style="float: left;"></div>
      <!--<div style="clear: both;"></div>-->
      <!--<br clear="all" />-->
      <div id="retention" style="float: right;"></div>
      <div id="retentionEvent" class="dropdown_label">Retention Event:</div>
      <div id="start" style="float: right;"></div>
      <div id="startEvent" class="dropdown_label">Start Event:</div>
      <div style="clear: both;"></div>
    </div>
    <div class="mixpanel-platform-section">
      <div class="dropdown_label_left">Retention Interval:</div>
      <div id="Interval" style="float: left;"></div>
      <div id="intervalSelect" class="dropdown_label" style="float: left;"></div>
      <!--<div style="clear: both;"></div>-->
      <div class="dropdown_label_left">Unit</div>
      <div id="unitSelect" style="float: left;"></div>
      <!--<div id="incomplete" style="float: left;"></div>-->
      <div class="dropdown_label_left">Include Incomplete Buckets?</div>
      <div class="checkbox">
  		<input type="checkbox" value="1" id="checkboxInput" name="" />
	  	<label for="checkboxInput"></label>
    	</div>
      <div style="clear: both;"></div>
    </div>
    <div id="dataChart" style="min-width: 310px; height: 750; margin: 0 auto"></div>
    <script>
      // /**
      //   * @license Highcharts JS v5.0.7 (2017-01-17)
      //   * Exporting module
      //   *
      //   * (c) 2010-2016 Torstein Honsi
      //   *
      //   * License: www.highcharts.com/license
      //   */
      //   (function(factory) {
      //       if (typeof module === 'object' && module.exports) {
      //           module.exports = factory;
      //       } else {
      //           factory(Highcharts);
      //       }
      //   }(function(Highcharts) {
      //       (function(H) {
      //           /**
      //           * Exporting module
      //           *
      //           * (c) 2010-2016 Torstein Honsi
      //           *
      //           * License: www.highcharts.com/license
      //           */
        
      //           /* eslint indent:0 */
      //           'use strict';
      //           debugger
      //           // create shortcuts
      //           H.defaultOptions = H.defaultOptions || {
      //             "colors": [
      //               "#7cb5ec",
      //               "#434348",
      //               "#90ed7d",
      //               "#f7a35c",
      //               "#8085e9",
      //               "#f15c80",
      //               "#e4d354",
      //               "#2b908f",
      //               "#f45b5b",
      //               "#91e8e1"
      //             ],
      //             "symbols": [
      //               "circle",
      //               "diamond",
      //               "square",
      //               "triangle",
      //               "triangle-down"
      //             ],
      //             "lang": {
      //               "loading": "Loading...",
      //               "months": [
      //                 "January",
      //                 "February",
      //                 "March",
      //                 "April",
      //                 "May",
      //                 "June",
      //                 "July",
      //                 "August",
      //                 "September",
      //                 "October",
      //                 "November",
      //                 "December"
      //               ],
      //               "shortMonths": [
      //                 "Jan",
      //                 "Feb",
      //                 "Mar",
      //                 "Apr",
      //                 "May",
      //                 "Jun",
      //                 "Jul",
      //                 "Aug",
      //                 "Sep",
      //                 "Oct",
      //                 "Nov",
      //                 "Dec"
      //               ],
      //               "weekdays": [
      //                 "Sunday",
      //                 "Monday",
      //                 "Tuesday",
      //                 "Wednesday",
      //                 "Thursday",
      //                 "Friday",
      //                 "Saturday"
      //               ],
      //               "decimalPoint": ".",
      //               "numericSymbols": [
      //                 "k",
      //                 "M",
      //                 "G",
      //                 "T",
      //                 "P",
      //                 "E"
      //               ],
      //               "resetZoom": "Reset zoom",
      //               "resetZoomTitle": "Reset zoom level 1:1",
      //               "thousandsSep": " "
      //             },
      //             "global": {
      //               "useUTC": true,
      //               "VMLRadialGradientURL": "http:\/\/code.highcharts.com\/5.0.7\/gfx\/vml-radial-gradient.png"
      //             },
      //             "chart": {
      //               "borderRadius": 0,
      //               "defaultSeriesType": "line",
      //               "ignoreHiddenSeries": true,
      //               "spacing": [
      //                 10,
      //                 10,
      //                 15,
      //                 10
      //               ],
      //               "resetZoomButton": {
      //                 "theme": {
      //                   "zIndex": 20
      //                 },
      //                 "position": {
      //                   "align": "right",
      //                   "x": -10,
      //                   "y": 10
      //                 }
      //               },
      //               "width": null,
      //               "height": null,
      //               "borderColor": "#335cad",
      //               "backgroundColor": "#ffffff",
      //               "plotBorderColor": "#cccccc"
      //             },
      //             "title": {
      //               "text": "Chart title",
      //               "align": "center",
      //               "margin": 15,
      //               "widthAdjust": -44
      //             },
      //             "subtitle": {
      //               "text": "",
      //               "align": "center",
      //               "widthAdjust": -44
      //             },
      //             "plotOptions": {
      //               "line": {
      //                 "lineWidth": 2,
      //                 "allowPointSelect": false,
      //                 "showCheckbox": false,
      //                 "animation": {
      //                   "duration": 1000
      //                 },
      //                 "events": {
                        
      //                 },
      //                 "marker": {
      //                   "lineWidth": 0,
      //                   "lineColor": "#ffffff",
      //                   "radius": 4,
      //                   "states": {
      //                     "hover": {
      //                       "animation": {
      //                         "duration": 50
      //                       },
      //                       "enabled": true,
      //                       "radiusPlus": 2,
      //                       "lineWidthPlus": 1
      //                     },
      //                     "select": {
      //                       "fillColor": "#cccccc",
      //                       "lineColor": "#000000",
      //                       "lineWidth": 2
      //                     }
      //                   }
      //                 },
      //                 "point": {
      //                   "events": {
                          
      //                   }
      //                 },
      //                 "dataLabels": {
      //                   "align": "center",
      //                   "style": {
      //                     "fontSize": "11px",
      //                     "fontWeight": "bold",
      //                     "color": "contrast",
      //                     "textOutline": "1px contrast"
      //                   },
      //                   "verticalAlign": "bottom",
      //                   "x": 0,
      //                   "y": 0,
      //                   "padding": 5
      //                 },
      //                 "cropThreshold": 300,
      //                 "pointRange": 0,
      //                 "softThreshold": true,
      //                 "states": {
      //                   "hover": {
      //                     "lineWidthPlus": 1,
      //                     "marker": {
                            
      //                     },
      //                     "halo": {
      //                       "size": 10,
      //                       "opacity": 0.25
      //                     }
      //                   },
      //                   "select": {
      //                     "marker": {
                            
      //                     }
      //                   }
      //                 },
      //                 "stickyTracking": true,
      //                 "turboThreshold": 1000
      //               },
      //               "area": {
      //                 "lineWidth": 2,
      //                 "allowPointSelect": false,
      //                 "showCheckbox": false,
      //                 "animation": {
      //                   "duration": 1000
      //                 },
      //                 "events": {
                        
      //                 },
      //                 "marker": {
      //                   "lineWidth": 0,
      //                   "lineColor": "#ffffff",
      //                   "radius": 4,
      //                   "states": {
      //                     "hover": {
      //                       "animation": {
      //                         "duration": 50
      //                       },
      //                       "enabled": true,
      //                       "radiusPlus": 2,
      //                       "lineWidthPlus": 1
      //                     },
      //                     "select": {
      //                       "fillColor": "#cccccc",
      //                       "lineColor": "#000000",
      //                       "lineWidth": 2
      //                     }
      //                   }
      //                 },
      //                 "point": {
      //                   "events": {
                          
      //                   }
      //                 },
      //                 "dataLabels": {
      //                   "align": "center",
      //                   "style": {
      //                     "fontSize": "11px",
      //                     "fontWeight": "bold",
      //                     "color": "contrast",
      //                     "textOutline": "1px contrast"
      //                   },
      //                   "verticalAlign": "bottom",
      //                   "x": 0,
      //                   "y": 0,
      //                   "padding": 5
      //                 },
      //                 "cropThreshold": 300,
      //                 "pointRange": 0,
      //                 "softThreshold": false,
      //                 "states": {
      //                   "hover": {
      //                     "lineWidthPlus": 1,
      //                     "marker": {
                            
      //                     },
      //                     "halo": {
      //                       "size": 10,
      //                       "opacity": 0.25
      //                     }
      //                   },
      //                   "select": {
      //                     "marker": {
                            
      //                     }
      //                   }
      //                 },
      //                 "stickyTracking": true,
      //                 "turboThreshold": 1000,
      //                 "threshold": 0
      //               },
      //               "spline": {
      //                 "lineWidth": 2,
      //                 "allowPointSelect": false,
      //                 "showCheckbox": false,
      //                 "animation": {
      //                   "duration": 1000
      //                 },
      //                 "events": {
                        
      //                 },
      //                 "marker": {
      //                   "lineWidth": 0,
      //                   "lineColor": "#ffffff",
      //                   "radius": 4,
      //                   "states": {
      //                     "hover": {
      //                       "animation": {
      //                         "duration": 50
      //                       },
      //                       "enabled": true,
      //                       "radiusPlus": 2,
      //                       "lineWidthPlus": 1
      //                     },
      //                     "select": {
      //                       "fillColor": "#cccccc",
      //                       "lineColor": "#000000",
      //                       "lineWidth": 2
      //                     }
      //                   }
      //                 },
      //                 "point": {
      //                   "events": {
                          
      //                   }
      //                 },
      //                 "dataLabels": {
      //                   "align": "center",
      //                   "style": {
      //                     "fontSize": "11px",
      //                     "fontWeight": "bold",
      //                     "color": "contrast",
      //                     "textOutline": "1px contrast"
      //                   },
      //                   "verticalAlign": "bottom",
      //                   "x": 0,
      //                   "y": 0,
      //                   "padding": 5
      //                 },
      //                 "cropThreshold": 300,
      //                 "pointRange": 0,
      //                 "softThreshold": true,
      //                 "states": {
      //                   "hover": {
      //                     "lineWidthPlus": 1,
      //                     "marker": {
                            
      //                     },
      //                     "halo": {
      //                       "size": 10,
      //                       "opacity": 0.25
      //                     }
      //                   },
      //                   "select": {
      //                     "marker": {
                            
      //                     }
      //                   }
      //                 },
      //                 "stickyTracking": true,
      //                 "turboThreshold": 1000
      //               },
      //               "areaspline": {
      //                 "lineWidth": 2,
      //                 "allowPointSelect": false,
      //                 "showCheckbox": false,
      //                 "animation": {
      //                   "duration": 1000
      //                 },
      //                 "events": {
                        
      //                 },
      //                 "marker": {
      //                   "lineWidth": 0,
      //                   "lineColor": "#ffffff",
      //                   "radius": 4,
      //                   "states": {
      //                     "hover": {
      //                       "animation": {
      //                         "duration": 50
      //                       },
      //                       "enabled": true,
      //                       "radiusPlus": 2,
      //                       "lineWidthPlus": 1
      //                     },
      //                     "select": {
      //                       "fillColor": "#cccccc",
      //                       "lineColor": "#000000",
      //                       "lineWidth": 2
      //                     }
      //                   }
      //                 },
      //                 "point": {
      //                   "events": {
                          
      //                   }
      //                 },
      //                 "dataLabels": {
      //                   "align": "center",
      //                   "style": {
      //                     "fontSize": "11px",
      //                     "fontWeight": "bold",
      //                     "color": "contrast",
      //                     "textOutline": "1px contrast"
      //                   },
      //                   "verticalAlign": "bottom",
      //                   "x": 0,
      //                   "y": 0,
      //                   "padding": 5
      //                 },
      //                 "cropThreshold": 300,
      //                 "pointRange": 0,
      //                 "softThreshold": false,
      //                 "states": {
      //                   "hover": {
      //                     "lineWidthPlus": 1,
      //                     "marker": {
                            
      //                     },
      //                     "halo": {
      //                       "size": 10,
      //                       "opacity": 0.25
      //                     }
      //                   },
      //                   "select": {
      //                     "marker": {
                            
      //                     }
      //                   }
      //                 },
      //                 "stickyTracking": true,
      //                 "turboThreshold": 1000,
      //                 "threshold": 0
      //               },
      //               "column": {
      //                 "lineWidth": 2,
      //                 "allowPointSelect": false,
      //                 "showCheckbox": false,
      //                 "animation": {
      //                   "duration": 1000
      //                 },
      //                 "events": {
                        
      //                 },
      //                 "marker": null,
      //                 "point": {
      //                   "events": {
                          
      //                   }
      //                 },
      //                 "dataLabels": {
      //                   "align": null,
      //                   "style": {
      //                     "fontSize": "11px",
      //                     "fontWeight": "bold",
      //                     "color": "contrast",
      //                     "textOutline": "1px contrast"
      //                   },
      //                   "verticalAlign": null,
      //                   "x": 0,
      //                   "y": null,
      //                   "padding": 5
      //                 },
      //                 "cropThreshold": 50,
      //                 "pointRange": null,
      //                 "softThreshold": false,
      //                 "states": {
      //                   "hover": {
      //                     "lineWidthPlus": 1,
      //                     "marker": {
                            
      //                     },
      //                     "halo": false,
      //                     "brightness": 0.1,
      //                     "shadow": false
      //                   },
      //                   "select": {
      //                     "marker": {
                            
      //                     },
      //                     "color": "#cccccc",
      //                     "borderColor": "#000000",
      //                     "shadow": false
      //                   }
      //                 },
      //                 "stickyTracking": false,
      //                 "turboThreshold": 1000,
      //                 "borderRadius": 0,
      //                 "groupPadding": 0.2,
      //                 "pointPadding": 0.1,
      //                 "minPointLength": 0,
      //                 "startFromThreshold": true,
      //                 "tooltip": {
      //                   "distance": 6
      //                 },
      //                 "threshold": 0,
      //                 "borderColor": "#ffffff"
      //               },
      //               "bar": {
      //                 "lineWidth": 2,
      //                 "allowPointSelect": false,
      //                 "showCheckbox": false,
      //                 "animation": {
      //                   "duration": 1000
      //                 },
      //                 "events": {
                        
      //                 },
      //                 "marker": null,
      //                 "point": {
      //                   "events": {
                          
      //                   }
      //                 },
      //                 "dataLabels": {
      //                   "align": null,
      //                   "style": {
      //                     "fontSize": "11px",
      //                     "fontWeight": "bold",
      //                     "color": "contrast",
      //                     "textOutline": "1px contrast"
      //                   },
      //                   "verticalAlign": null,
      //                   "x": 0,
      //                   "y": null,
      //                   "padding": 5
      //                 },
      //                 "cropThreshold": 50,
      //                 "pointRange": null,
      //                 "softThreshold": false,
      //                 "states": {
      //                   "hover": {
      //                     "lineWidthPlus": 1,
      //                     "marker": {
                            
      //                     },
      //                     "halo": false,
      //                     "brightness": 0.1,
      //                     "shadow": false
      //                   },
      //                   "select": {
      //                     "marker": {
                            
      //                     },
      //                     "color": "#cccccc",
      //                     "borderColor": "#000000",
      //                     "shadow": false
      //                   }
      //                 },
      //                 "stickyTracking": false,
      //                 "turboThreshold": 1000,
      //                 "borderRadius": 0,
      //                 "groupPadding": 0.2,
      //                 "pointPadding": 0.1,
      //                 "minPointLength": 0,
      //                 "startFromThreshold": true,
      //                 "tooltip": {
      //                   "distance": 6
      //                 },
      //                 "threshold": 0,
      //                 "borderColor": "#ffffff"
      //               },
      //               "scatter": {
      //                 "lineWidth": 0,
      //                 "allowPointSelect": false,
      //                 "showCheckbox": false,
      //                 "animation": {
      //                   "duration": 1000
      //                 },
      //                 "events": {
                        
      //                 },
      //                 "marker": {
      //                   "lineWidth": 0,
      //                   "lineColor": "#ffffff",
      //                   "radius": 4,
      //                   "states": {
      //                     "hover": {
      //                       "animation": {
      //                         "duration": 50
      //                       },
      //                       "enabled": true,
      //                       "radiusPlus": 2,
      //                       "lineWidthPlus": 1
      //                     },
      //                     "select": {
      //                       "fillColor": "#cccccc",
      //                       "lineColor": "#000000",
      //                       "lineWidth": 2
      //                     }
      //                   },
      //                   "enabled": true
      //                 },
      //                 "point": {
      //                   "events": {
                          
      //                   }
      //                 },
      //                 "dataLabels": {
      //                   "align": "center",
      //                   "style": {
      //                     "fontSize": "11px",
      //                     "fontWeight": "bold",
      //                     "color": "contrast",
      //                     "textOutline": "1px contrast"
      //                   },
      //                   "verticalAlign": "bottom",
      //                   "x": 0,
      //                   "y": 0,
      //                   "padding": 5
      //                 },
      //                 "cropThreshold": 300,
      //                 "pointRange": 0,
      //                 "softThreshold": true,
      //                 "states": {
      //                   "hover": {
      //                     "lineWidthPlus": 1,
      //                     "marker": {
                            
      //                     },
      //                     "halo": {
      //                       "size": 10,
      //                       "opacity": 0.25
      //                     }
      //                   },
      //                   "select": {
      //                     "marker": {
                            
      //                     }
      //                   }
      //                 },
      //                 "stickyTracking": true,
      //                 "turboThreshold": 1000,
      //                 "tooltip": {
      //                   "headerFormat": "<span style=\"color:{point.color}\">\u25cf<\/span> <span style=\"font-size: 0.85em\"> {series.name}<\/span><br\/>",
      //                   "pointFormat": "x: <b>{point.x}<\/b><br\/>y: <b>{point.y}<\/b><br\/>"
      //                 }
      //               },
      //               "pie": {
      //                 "lineWidth": 2,
      //                 "allowPointSelect": false,
      //                 "showCheckbox": false,
      //                 "animation": {
      //                   "duration": 1000
      //                 },
      //                 "events": {
                        
      //                 },
      //                 "marker": null,
      //                 "point": {
      //                   "events": {
                          
      //                   }
      //                 },
      //                 "dataLabels": {
      //                   "align": "center",
      //                   "style": {
      //                     "fontSize": "11px",
      //                     "fontWeight": "bold",
      //                     "color": "contrast",
      //                     "textOutline": "1px contrast"
      //                   },
      //                   "verticalAlign": "bottom",
      //                   "x": 0,
      //                   "y": 0,
      //                   "padding": 5,
      //                   "distance": 30,
      //                   "enabled": true
      //                 },
      //                 "cropThreshold": 300,
      //                 "pointRange": 0,
      //                 "softThreshold": true,
      //                 "states": {
      //                   "hover": {
      //                     "lineWidthPlus": 1,
      //                     "marker": {
                            
      //                     },
      //                     "halo": {
      //                       "size": 10,
      //                       "opacity": 0.25
      //                     },
      //                     "brightness": 0.1,
      //                     "shadow": false
      //                   },
      //                   "select": {
      //                     "marker": {
                            
      //                     }
      //                   }
      //                 },
      //                 "stickyTracking": false,
      //                 "turboThreshold": 1000,
      //                 "center": [
      //                   null,
      //                   null
      //                 ],
      //                 "clip": false,
      //                 "colorByPoint": true,
      //                 "ignoreHiddenPoint": true,
      //                 "legendType": "point",
      //                 "size": null,
      //                 "showInLegend": false,
      //                 "slicedOffset": 10,
      //                 "tooltip": {
      //                   "followPointer": true
      //                 },
      //                 "borderColor": "#ffffff",
      //                 "borderWidth": 1
      //               }
      //             },
      //             "labels": {
      //               "style": {
      //                 "position": "absolute",
      //                 "color": "#333333"
      //               }
      //             },
      //             "legend": {
      //               "enabled": true,
      //               "align": "center",
      //               "layout": "horizontal",
      //               "borderColor": "#999999",
      //               "borderRadius": 0,
      //               "navigation": {
      //                 "activeColor": "#003399",
      //                 "inactiveColor": "#cccccc"
      //               },
      //               "itemStyle": {
      //                 "color": "#333333",
      //                 "fontSize": "12px",
      //                 "fontWeight": "bold",
      //                 "cursor": "pointer"
      //               },
      //               "itemHoverStyle": {
      //                 "color": "#000000"
      //               },
      //               "itemHiddenStyle": {
      //                 "color": "#cccccc"
      //               },
      //               "shadow": false,
      //               "itemCheckboxStyle": {
      //                 "position": "absolute",
      //                 "width": "13px",
      //                 "height": "13px"
      //               },
      //               "squareSymbol": true,
      //               "symbolPadding": 5,
      //               "verticalAlign": "bottom",
      //               "x": 0,
      //               "y": 0,
      //               "title": {
      //                 "style": {
      //                   "fontWeight": "bold"
      //                 }
      //               }
      //             },
      //             "loading": {
      //               "labelStyle": {
      //                 "fontWeight": "bold",
      //                 "position": "relative",
      //                 "top": "45%"
      //               },
      //               "style": {
      //                 "position": "absolute",
      //                 "backgroundColor": "#ffffff",
      //                 "opacity": 0.5,
      //                 "textAlign": "center"
      //               }
      //             },
      //             "tooltip": {
      //               "enabled": true,
      //               "animation": true,
      //               "borderRadius": 3,
      //               "dateTimeLabelFormats": {
      //                 "millisecond": "%A, %b %e, %H:%M:%S.%L",
      //                 "second": "%A, %b %e, %H:%M:%S",
      //                 "minute": "%A, %b %e, %H:%M",
      //                 "hour": "%A, %b %e, %H:%M",
      //                 "day": "%A, %b %e, %Y",
      //                 "week": "Week from %A, %b %e, %Y",
      //                 "month": "%B %Y",
      //                 "year": "%Y"
      //               },
      //               "footerFormat": "",
      //               "padding": 8,
      //               "snap": 10,
      //               "backgroundColor": "rgba(247,247,247,0.85)",
      //               "borderWidth": 1,
      //               "headerFormat": "<span style=\"font-size: 10px\">{point.key}<\/span><br\/>",
      //               "pointFormat": "<span style=\"color:{point.color}\">\u25cf<\/span> {series.name}: <b>{point.y}<\/b><br\/>",
      //               "shadow": true,
      //               "style": {
      //                 "color": "#333333",
      //                 "cursor": "default",
      //                 "fontSize": "12px",
      //                 "pointerEvents": "none",
      //                 "whiteSpace": "nowrap"
      //               }
      //             },
      //             "credits": {
      //               "enabled": true,
      //               "href": "http:\/\/www.highcharts.com",
      //               "position": {
      //                 "align": "right",
      //                 "x": -10,
      //                 "verticalAlign": "bottom",
      //                 "y": -5
      //               },
      //               "style": {
      //                 "cursor": "pointer",
      //                 "color": "#999999",
      //                 "fontSize": "9px"
      //               },
      //               "text": "Highcharts.com"
      //             }
      //           }
        
      //           var defaultOptions = H.defaultOptions,
      //               doc = H.doc,
      //               Chart = H.Chart,
      //               addEvent = H.addEvent,
      //               removeEvent = H.removeEvent,
      //               fireEvent = H.fireEvent,
      //               createElement = H.createElement,
      //               discardElement = H.discardElement,
      //               css = H.css,
      //               merge = H.merge,
      //               pick = H.pick,
      //               each = H.each,
      //               extend = H.extend,
      //               isTouchDevice = H.isTouchDevice,
      //               win = H.win,
      //               SVGRenderer = H.SVGRenderer;
        
      //           var symbols = H.Renderer.prototype.symbols;
        
      //           // Add language
      //           extend(defaultOptions.lang, {
      //               printChart: 'Print chart',
      //               downloadPNG: 'Download PNG image',
      //               downloadJPEG: 'Download JPEG image',
      //               downloadPDF: 'Download PDF document',
      //               downloadSVG: 'Download SVG vector image',
      //               contextButtonTitle: 'Chart context menu'
      //           });
        
      //           // Buttons and menus are collected in a separate config option set called 'navigation'.
      //           // This can be extended later to add control buttons like zoom and pan right click menus.
      //           defaultOptions.navigation = {
      //               buttonOptions: {
      //                   theme: {},
      //                   symbolSize: 14,
      //                   symbolX: 12.5,
      //                   symbolY: 10.5,
      //                   align: 'right',
      //                   buttonSpacing: 3,
      //                   height: 22,
      //                   // text: null,
      //                   verticalAlign: 'top',
      //                   width: 24
      //               }
      //           };
        
        
      //           // Presentational attributes
      //           merge(true, defaultOptions.navigation, {
      //               menuStyle: {
      //                   border: '1px solid #999999',
      //                   background: '#ffffff',
      //                   padding: '5px 0'
      //               },
      //               menuItemStyle: {
      //                   padding: '0.5em 1em',
      //                   background: 'none',
      //                   color: '#333333',
      //                   fontSize: isTouchDevice ? '14px' : '11px',
      //                   transition: 'background 250ms, color 250ms'
      //               },
      //               menuItemHoverStyle: {
      //                   background: '#335cad',
      //                   color: '#ffffff'
      //               },
      //               buttonOptions: {
      //                   symbolFill: '#666666',
      //                   symbolStroke: '#666666',
      //                   symbolStrokeWidth: 3,
      //                   theme: {
      //                       fill: '#ffffff', // capture hover
      //                       stroke: 'none',
      //                       padding: 5
      //                   }
      //               }
      //           });
        
        
        
      //           // Add the export related options
      //           defaultOptions.exporting = {
      //               //enabled: true,
      //               //filename: 'chart',
      //               type: 'image/png',
      //               url: 'https://export.highcharts.com/',
      //               //width: undefined,
      //               printMaxWidth: 780,
      //               scale: 2,
      //               buttons: {
      //                   contextButton: {
      //                       className: 'highcharts-contextbutton',
      //                       menuClassName: 'highcharts-contextmenu',
      //                       //x: -10,
      //                       symbol: 'menu',
      //                       _titleKey: 'contextButtonTitle',
      //                       menuItems: [{
      //                               textKey: 'printChart',
      //                               onclick: function() {
      //                                   this.print();
      //                               }
      //                           }, {
      //                               separator: true
      //                           }, {
      //                               textKey: 'downloadPNG',
      //                               onclick: function() {
      //                                   this.exportChart();
      //                               }
      //                           }, {
      //                               textKey: 'downloadJPEG',
      //                               onclick: function() {
      //                                   this.exportChart({
      //                                       type: 'image/jpeg'
      //                                   });
      //                               }
      //                           }, {
      //                               textKey: 'downloadPDF',
      //                               onclick: function() {
      //                                   this.exportChart({
      //                                       type: 'application/pdf'
      //                                   });
      //                               }
      //                           }, {
      //                               textKey: 'downloadSVG',
      //                               onclick: function() {
      //                                   this.exportChart({
      //                                       type: 'image/svg+xml'
      //                                   });
      //                               }
      //                           }
      //                           // Enable this block to add "View SVG" to the dropdown menu
      //                           /*
      //                           ,{
        
      //                           	text: 'View SVG',
      //                           	onclick: function () {
      //                           		var svg = this.getSVG()
      //                           			.replace(/</g, '\n&lt;')
      //                           			.replace(/>/g, '&gt;');
        
      //                           		doc.body.innerHTML = '<pre>' + svg + '</pre>';
      //                           	}
      //                           } // */
      //                       ]
      //                   }
      //               }
      //           };
        
      //           // Add the H.post utility
      //           H.post = function(url, data, formAttributes) {
      //               var name,
      //                   form;
        
      //               // create the form
      //               form = createElement('form', merge({
      //                   method: 'post',
      //                   action: url,
      //                   enctype: 'multipart/form-data'
      //               }, formAttributes), {
      //                   display: 'none'
      //               }, doc.body);
        
      //               // add the data
      //               for (name in data) {
      //                   createElement('input', {
      //                       type: 'hidden',
      //                       name: name,
      //                       value: data[name]
      //                   }, null, form);
      //               }
        
      //               // submit
      //               form.submit();
        
      //               // clean up
      //               discardElement(form);
      //           };
        
      //           extend(Chart.prototype, {
        
      //               /**
      //               * A collection of fixes on the produced SVG to account for expando properties,
      //               * browser bugs, VML problems and other. Returns a cleaned SVG.
      //               */
      //               sanitizeSVG: function(svg, options) {
      //                   // Move HTML into a foreignObject
      //                   if (options && options.exporting && options.exporting.allowHTML) {
      //                       var html = svg.match(/<\/svg>(.*?$)/);
      //                       if (html) {
      //                           html = '<foreignObject x="0" y="0" ' +
      //                               'width="' + options.chart.width + '" ' +
      //                               'height="' + options.chart.height + '">' +
      //                               '<body xmlns="http://www.w3.org/1999/xhtml">' +
      //                               html[1] +
      //                               '</body>' +
      //                               '</foreignObject>';
      //                           svg = svg.replace('</svg>', html + '</svg>');
      //                       }
      //                   }
        
      //                   svg = svg
      //                       .replace(/zIndex="[^"]+"/g, '')
      //                       .replace(/isShadow="[^"]+"/g, '')
      //                       .replace(/symbolName="[^"]+"/g, '')
      //                       .replace(/jQuery[0-9]+="[^"]+"/g, '')
      //                       .replace(/url\(("|&quot;)(\S+)("|&quot;)\)/g, 'url($2)')
      //                       .replace(/url\([^#]+#/g, 'url(#')
      //                       .replace(/<svg /, '<svg xmlns:xlink="http://www.w3.org/1999/xlink" ')
      //                       .replace(/ (NS[0-9]+\:)?href=/g, ' xlink:href=') // #3567
      //                       .replace(/\n/, ' ')
      //                       // Any HTML added to the container after the SVG (#894)
      //                       .replace(/<\/svg>.*?$/, '</svg>')
      //                       // Batik doesn't support rgba fills and strokes (#3095)
      //                       .replace(/(fill|stroke)="rgba\(([ 0-9]+,[ 0-9]+,[ 0-9]+),([ 0-9\.]+)\)"/g, '$1="rgb($2)" $1-opacity="$3"')
      //                       /* This fails in IE < 8
      //                       .replace(/([0-9]+)\.([0-9]+)/g, function(s1, s2, s3) { // round off to save weight
      //                       	return s2 +'.'+ s3[0];
      //                       })*/
        
      //                   // Replace HTML entities, issue #347
      //                   .replace(/&nbsp;/g, '\u00A0') // no-break space
      //                       .replace(/&shy;/g, '\u00AD'); // soft hyphen
        
        
      //                   // IE specific
      //                   svg = svg
      //                       .replace(/<IMG /g, '<image ')
      //                       .replace(/<(\/?)TITLE>/g, '<$1title>')
      //                       .replace(/height=([^" ]+)/g, 'height="$1"')
      //                       .replace(/width=([^" ]+)/g, 'width="$1"')
      //                       .replace(/hc-svg-href="([^"]+)">/g, 'xlink:href="$1"/>')
      //                       .replace(/ id=([^" >]+)/g, ' id="$1"') // #4003
      //                       .replace(/class=([^" >]+)/g, 'class="$1"')
      //                       .replace(/ transform /g, ' ')
      //                       .replace(/:(path|rect)/g, '$1')
      //                       .replace(/style="([^"]+)"/g, function(s) {
      //                           return s.toLowerCase();
      //                       });
        
        
      //                   return svg;
      //               },
        
      //               /**
      //               * Return innerHTML of chart. Used as hook for plugins.
      //               */
      //               getChartHTML: function() {
        
      //                   return this.container.innerHTML;
      //               },
        
      //               /**
      //               * Return an SVG representation of the chart.
      //               *
      //               * @param additionalOptions {Object} Additional chart options for the
      //               *    generated SVG representation. For collections like `xAxis`, `yAxis` or
      //               *    `series`, the additional options is either merged in to the orininal
      //               *    item of the same `id`, or to the first item if a commin id is not
      //               *    found.
      //               */
      //               getSVG: function(additionalOptions) {
      //                   var chart = this,
      //                       chartCopy,
      //                       sandbox,
      //                       svg,
      //                       seriesOptions,
      //                       sourceWidth,
      //                       sourceHeight,
      //                       cssWidth,
      //                       cssHeight,
      //                       options = merge(chart.options, additionalOptions); // copy the options and add extra options
        
        
      //                   // IE compatibility hack for generating SVG content that it doesn't really understand
      //                   if (!doc.createElementNS) {
      //                       doc.createElementNS = function(ns, tagName) {
      //                           return doc.createElement(tagName);
      //                       };
      //                   }
        
      //                   // create a sandbox where a new chart will be generated
      //                   sandbox = createElement('div', null, {
      //                       position: 'absolute',
      //                       top: '-9999em',
      //                       width: chart.chartWidth + 'px',
      //                       height: chart.chartHeight + 'px'
      //                   }, doc.body);
        
      //                   // get the source size
      //                   cssWidth = chart.renderTo.style.width;
      //                   cssHeight = chart.renderTo.style.height;
      //                   sourceWidth = options.exporting.sourceWidth ||
      //                       options.chart.width ||
      //                       (/px$/.test(cssWidth) && parseInt(cssWidth, 10)) ||
      //                       600;
      //                   sourceHeight = options.exporting.sourceHeight ||
      //                       options.chart.height ||
      //                       (/px$/.test(cssHeight) && parseInt(cssHeight, 10)) ||
      //                       400;
        
      //                   // override some options
      //                   extend(options.chart, {
      //                       animation: false,
      //                       renderTo: sandbox,
      //                       forExport: true,
      //                       renderer: 'SVGRenderer',
      //                       width: sourceWidth,
      //                       height: sourceHeight
      //                   });
      //                   options.exporting.enabled = false; // hide buttons in print
      //                   delete options.data; // #3004
        
      //                   // prepare for replicating the chart
      //                   options.series = [];
      //                   each(chart.series, function(serie) {
      //                       seriesOptions = merge(serie.userOptions, { // #4912
      //                           animation: false, // turn off animation
      //                           enableMouseTracking: false,
      //                           showCheckbox: false,
      //                           visible: serie.visible
      //                       });
        
      //                       if (!seriesOptions.isInternal) { // used for the navigator series that has its own option set
      //                           options.series.push(seriesOptions);
      //                       }
      //                   });
        
      //                   // Assign an internal key to ensure a one-to-one mapping (#5924)
      //                   each(chart.axes, function(axis) {
      //                       axis.userOptions.internalKey = H.uniqueKey();
      //                   });
        
      //                   // generate the chart copy
      //                   chartCopy = new H.Chart(options, chart.callback);
        
      //                   // Axis options and series options  (#2022, #3900, #5982)
      //                   if (additionalOptions) {
      //                       each(['xAxis', 'yAxis', 'series'], function(coll) {
      //                           var collOptions = {};
      //                           if (additionalOptions[coll]) {
      //                               collOptions[coll] = additionalOptions[coll];
      //                               chartCopy.update(collOptions);
      //                           }
      //                       });
      //                   }
        
      //                   // Reflect axis extremes in the export (#5924)
      //                   each(chart.axes, function(axis) {
      //                       var axisCopy = H.find(chartCopy.axes, function(copy) {
      //                               return copy.options.internalKey ===
      //                                   axis.userOptions.internalKey;
      //                           }),
      //                           extremes = axis.getExtremes(),
      //                           userMin = extremes.userMin,
      //                           userMax = extremes.userMax;
        
      //                       if (axisCopy && (userMin !== undefined || userMax !== undefined)) {
      //                           axisCopy.setExtremes(userMin, userMax, true, false);
      //                       }
      //                   });
        
      //                   // Get the SVG from the container's innerHTML
      //                   svg = chartCopy.getChartHTML();
        
      //                   svg = chart.sanitizeSVG(svg, options);
        
      //                   // free up memory
      //                   options = null;
      //                   chartCopy.destroy();
      //                   discardElement(sandbox);
        
      //                   return svg;
      //               },
        
      //               getSVGForExport: function(options, chartOptions) {
      //                   var chartExportingOptions = this.options.exporting;
        
      //                   return this.getSVG(merge({
      //                           chart: {
      //                               borderRadius: 0
      //                           }
      //                       },
      //                       chartExportingOptions.chartOptions,
      //                       chartOptions, {
      //                           exporting: {
      //                               sourceWidth: (options && options.sourceWidth) || chartExportingOptions.sourceWidth,
      //                               sourceHeight: (options && options.sourceHeight) || chartExportingOptions.sourceHeight
      //                           }
      //                       }
      //                   ));
      //               },
        
      //               /**
      //               * Submit the SVG representation of the chart to the server
      //               * @param {Object} options Exporting options. Possible members are url, type, width and formAttributes.
      //               * @param {Object} chartOptions Additional chart options for the SVG representation of the chart
      //               */
      //               exportChart: function(options, chartOptions) {
        
      //                   var svg = this.getSVGForExport(options, chartOptions);
        
      //                   // merge the options
      //                   options = merge(this.options.exporting, options);
        
      //                   // do the post
      //                   H.post(options.url, {
      //                       filename: options.filename || 'chart',
      //                       type: options.type,
      //                       width: options.width || 0, // IE8 fails to post undefined correctly, so use 0
      //                       scale: options.scale,
      //                       svg: svg
      //                   }, options.formAttributes);
        
      //               },
        
      //               /**
      //               * Print the chart
      //               */
      //               print: function() {
        
      //                   var chart = this,
      //                       container = chart.container,
      //                       origDisplay = [],
      //                       origParent = container.parentNode,
      //                       body = doc.body,
      //                       childNodes = body.childNodes,
      //                       printMaxWidth = chart.options.exporting.printMaxWidth,
      //                       resetParams,
      //                       handleMaxWidth;
        
      //                   if (chart.isPrinting) { // block the button while in printing mode
      //                       return;
      //                   }
        
      //                   chart.isPrinting = true;
      //                   chart.pointer.reset(null, 0);
        
      //                   fireEvent(chart, 'beforePrint');
        
      //                   // Handle printMaxWidth
      //                   handleMaxWidth = printMaxWidth && chart.chartWidth > printMaxWidth;
      //                   if (handleMaxWidth) {
      //                       resetParams = [chart.options.chart.width, undefined, false];
      //                       chart.setSize(printMaxWidth, undefined, false);
      //                   }
        
      //                   // hide all body content
      //                   each(childNodes, function(node, i) {
      //                       if (node.nodeType === 1) {
      //                           origDisplay[i] = node.style.display;
      //                           node.style.display = 'none';
      //                       }
      //                   });
        
      //                   // pull out the chart
      //                   body.appendChild(container);
        
      //                   // print
      //                   win.focus(); // #1510
      //                   win.print();
        
      //                   // allow the browser to prepare before reverting
      //                   setTimeout(function() {
        
      //                       // put the chart back in
      //                       origParent.appendChild(container);
        
      //                       // restore all body content
      //                       each(childNodes, function(node, i) {
      //                           if (node.nodeType === 1) {
      //                               node.style.display = origDisplay[i];
      //                           }
      //                       });
        
      //                       chart.isPrinting = false;
        
      //                       // Reset printMaxWidth
      //                       if (handleMaxWidth) {
      //                           chart.setSize.apply(chart, resetParams);
      //                       }
        
      //                       fireEvent(chart, 'afterPrint');
        
      //                   }, 1000);
        
      //               },
        
      //               /**
      //               * Display a popup menu for choosing the export type
      //               *
      //               * @param {String} className An identifier for the menu
      //               * @param {Array} items A collection with text and onclicks for the items
      //               * @param {Number} x The x position of the opener button
      //               * @param {Number} y The y position of the opener button
      //               * @param {Number} width The width of the opener button
      //               * @param {Number} height The height of the opener button
      //               */
      //               contextMenu: function(className, items, x, y, width, height, button) {
      //                   var chart = this,
      //                       navOptions = chart.options.navigation,
      //                       chartWidth = chart.chartWidth,
      //                       chartHeight = chart.chartHeight,
      //                       cacheName = 'cache-' + className,
      //                       menu = chart[cacheName],
      //                       menuPadding = Math.max(width, height), // for mouse leave detection
      //                       innerMenu,
      //                       hide,
      //                       menuStyle,
      //                       removeMouseUp;
        
      //                   // create the menu only the first time
      //                   if (!menu) {
        
      //                       // create a HTML element above the SVG
      //                       chart[cacheName] = menu = createElement('div', {
      //                           className: className
      //                       }, {
      //                           position: 'absolute',
      //                           zIndex: 1000,
      //                           padding: menuPadding + 'px'
      //                       }, chart.container);
        
      //                       innerMenu = createElement('div', {
      //                           className: 'highcharts-menu'
      //                       }, null, menu);
        
        
      //                       // Presentational CSS
      //                       css(innerMenu, extend({
      //                           MozBoxShadow: '3px 3px 10px #888',
      //                           WebkitBoxShadow: '3px 3px 10px #888',
      //                           boxShadow: '3px 3px 10px #888'
      //                       }, navOptions.menuStyle));
        
        
      //                       // hide on mouse out
      //                       hide = function() {
      //                           css(menu, {
      //                               display: 'none'
      //                           });
      //                           if (button) {
      //                               button.setState(0);
      //                           }
      //                           chart.openMenu = false;
      //                       };
        
      //                       // Hide the menu some time after mouse leave (#1357)
      //                       addEvent(menu, 'mouseleave', function() {
      //                           menu.hideTimer = setTimeout(hide, 500);
      //                       });
      //                       addEvent(menu, 'mouseenter', function() {
      //                           clearTimeout(menu.hideTimer);
      //                       });
        
        
      //                       // Hide it on clicking or touching outside the menu (#2258, #2335,
      //                       // #2407)
      //                       removeMouseUp = addEvent(doc, 'mouseup', function(e) {
      //                           if (!chart.pointer.inClass(e.target, className)) {
      //                               hide();
      //                           }
      //                       });
      //                       addEvent(chart, 'destroy', removeMouseUp);
        
        
      //                       // create the items
      //                       each(items, function(item) {
      //                           if (item) {
      //                               var element;
        
      //                               if (item.separator) {
      //                                   element = createElement('hr', null, null, innerMenu);
        
      //                               } else {
      //                                   element = createElement('div', {
      //                                       className: 'highcharts-menu-item',
      //                                       onclick: function(e) {
      //                                           if (e) { // IE7
      //                                               e.stopPropagation();
      //                                           }
      //                                           hide();
      //                                           if (item.onclick) {
      //                                               item.onclick.apply(chart, arguments);
      //                                           }
      //                                       },
      //                                       innerHTML: item.text || chart.options.lang[item.textKey]
      //                                   }, null, innerMenu);
        
        
      //                                   element.onmouseover = function() {
      //                                       css(this, navOptions.menuItemHoverStyle);
      //                                   };
      //                                   element.onmouseout = function() {
      //                                       css(this, navOptions.menuItemStyle);
      //                                   };
      //                                   css(element, extend({
      //                                       cursor: 'pointer'
      //                                   }, navOptions.menuItemStyle));
        
      //                               }
        
      //                               // Keep references to menu divs to be able to destroy them
      //                               chart.exportDivElements.push(element);
      //                           }
      //                       });
        
      //                       // Keep references to menu and innerMenu div to be able to destroy them
      //                       chart.exportDivElements.push(innerMenu, menu);
        
      //                       chart.exportMenuWidth = menu.offsetWidth;
      //                       chart.exportMenuHeight = menu.offsetHeight;
      //                   }
        
      //                   menuStyle = {
      //                       display: 'block'
      //                   };
        
      //                   // if outside right, right align it
      //                   if (x + chart.exportMenuWidth > chartWidth) {
      //                       menuStyle.right = (chartWidth - x - width - menuPadding) + 'px';
      //                   } else {
      //                       menuStyle.left = (x - menuPadding) + 'px';
      //                   }
      //                   // if outside bottom, bottom align it
      //                   if (y + height + chart.exportMenuHeight > chartHeight && button.alignOptions.verticalAlign !== 'top') {
      //                       menuStyle.bottom = (chartHeight - y - menuPadding) + 'px';
      //                   } else {
      //                       menuStyle.top = (y + height - menuPadding) + 'px';
      //                   }
        
      //                   css(menu, menuStyle);
      //                   chart.openMenu = true;
      //               },
        
      //               /**
      //               * Add the export button to the chart
      //               */
      //               addButton: function(options) {
      //                   var chart = this,
      //                       renderer = chart.renderer,
      //                       btnOptions = merge(chart.options.navigation.buttonOptions, options),
      //                       onclick = btnOptions.onclick,
      //                       menuItems = btnOptions.menuItems,
      //                       symbol,
      //                       button,
      //                       symbolSize = btnOptions.symbolSize || 12;
      //                   if (!chart.btnCount) {
      //                       chart.btnCount = 0;
      //                   }
        
      //                   // Keeps references to the button elements
      //                   if (!chart.exportDivElements) {
      //                       chart.exportDivElements = [];
      //                       chart.exportSVGElements = [];
      //                   }
        
      //                   if (btnOptions.enabled === false) {
      //                       return;
      //                   }
        
        
      //                   var attr = btnOptions.theme,
      //                       states = attr.states,
      //                       hover = states && states.hover,
      //                       select = states && states.select,
      //                       callback;
        
      //                   delete attr.states;
        
      //                   if (onclick) {
      //                       callback = function(e) {
      //                           e.stopPropagation();
      //                           onclick.call(chart, e);
      //                       };
        
      //                   } else if (menuItems) {
      //                       callback = function() {
      //                           chart.contextMenu(
      //                               button.menuClassName,
      //                               menuItems,
      //                               button.translateX,
      //                               button.translateY,
      //                               button.width,
      //                               button.height,
      //                               button
      //                           );
      //                           button.setState(2);
      //                       };
      //                   }
        
        
      //                   if (btnOptions.text && btnOptions.symbol) {
      //                       attr.paddingLeft = pick(attr.paddingLeft, 25);
        
      //                   } else if (!btnOptions.text) {
      //                       extend(attr, {
      //                           width: btnOptions.width,
      //                           height: btnOptions.height,
      //                           padding: 0
      //                       });
      //                   }
        
      //                   button = renderer.button(btnOptions.text, 0, 0, callback, attr, hover, select)
      //                       .addClass(options.className)
      //                       .attr({
        
      //                           'stroke-linecap': 'round',
        
      //                           title: chart.options.lang[btnOptions._titleKey],
      //                           zIndex: 3 // #4955
      //                       });
      //                   button.menuClassName = options.menuClassName || 'highcharts-menu-' + chart.btnCount++;
        
      //                   if (btnOptions.symbol) {
      //                       symbol = renderer.symbol(
      //                               btnOptions.symbol,
      //                               btnOptions.symbolX - (symbolSize / 2),
      //                               btnOptions.symbolY - (symbolSize / 2),
      //                               symbolSize,
      //                               symbolSize
      //                           )
      //                           .addClass('highcharts-button-symbol')
      //                           .attr({
      //                               zIndex: 1
      //                           }).add(button);
        
        
      //                       symbol.attr({
      //                           stroke: btnOptions.symbolStroke,
      //                           fill: btnOptions.symbolFill,
      //                           'stroke-width': btnOptions.symbolStrokeWidth || 1
      //                       });
        
      //                   }
        
      //                   button.add()
      //                       .align(extend(btnOptions, {
      //                           width: button.width,
      //                           x: pick(btnOptions.x, chart.buttonOffset) // #1654
      //                       }), true, 'spacingBox');
        
      //                   chart.buttonOffset += (button.width + btnOptions.buttonSpacing) * (btnOptions.align === 'right' ? -1 : 1);
        
      //                   chart.exportSVGElements.push(button, symbol);
        
      //               },
        
      //               /**
      //               * Destroy the buttons.
      //               */
      //               destroyExport: function(e) {
      //                   var chart = e ? e.target : this,
      //                       exportSVGElements = chart.exportSVGElements,
      //                       exportDivElements = chart.exportDivElements;
        
      //                   // Destroy the extra buttons added
      //                   if (exportSVGElements) {
      //                       each(exportSVGElements, function(elem, i) {
        
      //                           // Destroy and null the svg/vml elements
      //                           if (elem) { // #1822
      //                               elem.onclick = elem.ontouchstart = null;
      //                               chart.exportSVGElements[i] = elem.destroy();
      //                           }
      //                       });
      //                       exportSVGElements.length = 0;
      //                   }
        
      //                   // Destroy the divs for the menu
      //                   if (exportDivElements) {
      //                       each(exportDivElements, function(elem, i) {
        
      //                           // Remove the event handler
      //                           clearTimeout(elem.hideTimer); // #5427
      //                           removeEvent(elem, 'mouseleave');
        
      //                           // Remove inline events
      //                           chart.exportDivElements[i] = elem.onmouseout = elem.onmouseover = elem.ontouchstart = elem.onclick = null;
        
      //                           // Destroy the div by moving to garbage bin
      //                           discardElement(elem);
      //                       });
      //                       exportDivElements.length = 0;
      //                   }
      //               }
      //           });
        
        
        
        
      //           symbols.menu = function(x, y, width, height) {
      //               var arr = [
      //                   'M', x, y + 2.5,
      //                   'L', x + width, y + 2.5,
      //                   'M', x, y + height / 2 + 0.5,
      //                   'L', x + width, y + height / 2 + 0.5,
      //                   'M', x, y + height - 1.5,
      //                   'L', x + width, y + height - 1.5
      //               ];
      //               return arr;
      //           };
        
      //           // Add the buttons on chart load
      //           Chart.prototype.renderExporting = function() {
      //               var n,
      //                   exportingOptions = this.options.exporting,
      //                   buttons = exportingOptions.buttons,
      //                   isDirty = this.isDirtyExporting || !this.exportSVGElements;
        
      //               this.buttonOffset = 0;
      //               if (this.isDirtyExporting) {
      //                   this.destroyExport();
      //               }
        
      //               if (isDirty && exportingOptions.enabled !== false) {
        
      //                   for (n in buttons) {
      //                       this.addButton(buttons[n]);
      //                   }
        
      //                   this.isDirtyExporting = false;
      //               }
        
      //               // Destroy the export elements at chart destroy
      //               addEvent(this, 'destroy', this.destroyExport);
      //           };
        
      //           Chart.prototype.callbacks.push(function(chart) {
        
      //               function update(prop, options, redraw) {
      //                   chart.isDirtyExporting = true;
      //                   merge(true, chart.options[prop], options);
      //                   if (pick(redraw, true)) {
      //                       chart.redraw();
      //                   }
        
      //               }
        
      //               chart.renderExporting();
        
      //               addEvent(chart, 'redraw', chart.renderExporting);
        
      //               // Add update methods to handle chart.update and chart.exporting.update
      //               // and chart.navigation.update.
      //               each(['exporting', 'navigation'], function(prop) {
      //                   chart[prop] = {
      //                       update: function(options, redraw) {
      //                           update(prop, options, redraw);
      //                       }
      //                   };
      //               });
      //           });
        
      //       }(Highcharts));
      //   }));
      
    </script>
    <script>
    
    
    debugger
		var dateSelect = $('#dateSelect').MPDatepicker();
		var startEvent = $('#start').MPEventSelect();
		var retentionEvent = $('#retention').MPEventSelect();
	
  	var unitSelect = $('#unitSelect').MPSelect({
		  items: [{
		    label: "Day", value:'day'
		  },{
		    label: "Week", value:'week'
		  },{
		    label: "Month", value:'month'
		  }]
  	});
  	
  	var intervalSelect = $('#intervalSelect').MPSelect(getIntervalDropdownValues());
  	function getIntervalDropdownValues(){
  	  dropdownItems = []
  	  switch(unitSelect.MPSelect('value')) {
        case 'day':
          dropdownLength = 365
          break;
        case 'week':
          dropdownLength = 52
          break;
        case 'month':
           dropdownLength = 12
          break;
        default:
            dropdownLength = 30
      }
		  for (i = 1; i <= dropdownLength; i++) { 
        dropdownItems.push({label: i.toString(), value: i})
      }
      return {items: dropdownItems}
  	}
	
	  function intervalDecider(length){
	    var incompleteBool = document.getElementById('checkboxInput').checked
	    if (incompleteBool === true){
	      return length
	    }
	    else {
	      return (length - 2)
	    }
	  }
	
	  function parseRetentionResults(retentionValues){
	    var seriesData = [];
      for (var key in retentionValues) {
        if (retentionValues.hasOwnProperty(key)){
        	holdingDictionary = {}
        	holdingDictionary[key] = []
          cohortCount = retentionValues[key]["first"]
          intervals = retentionValues[key]["counts"]
          
          seriesLength = intervalDecider(Object.keys(intervals).length)
            
          for (i = 0; i < seriesLength ; i++){
            var intervalValue = intervals[i]
            var percentage = (intervalValue / cohortCount) * 100
            
            if (percentage > 0){
              holdingDictionary[key].push(Math.round(percentage * 100) / 100)
            }
            else {
              holdingDictionary[key].push(null)
            }
          }
        }
        seriesData.push(holdingDictionary)  
      }
    
      var finalSeriesArray = []
  
      for (i = 0; i < (seriesData.length); i++){
          key = Object.keys(seriesData[i])[0]
          dataDictionary = {}
          dataDictionary["name"] = key
          dataDictionary["data"] = seriesData[i][key]
          finalSeriesArray.push(dataDictionary)
      }
      try {
        graphChart(finalSeriesArray)
      }
      catch(err) {
          console.log(err.message)
      }
	  }
	  
		function runQuery() {
  	  var from_date = dateSelect.MPDatepicker('value').from.toISOString().slice(0, -14);
  	  var to_date = dateSelect.MPDatepicker('value').to.toISOString().slice(0, -14);
  	  var start = startEvent.MPEventSelect('value');
  	  var retention = retentionEvent.MPEventSelect('value');
  	  var interval = intervalSelect.MPSelect('value');
  	  var unit = unitSelect.MPSelect('value');
  		var params = {
  		      from: from_date,
  		      to: to_date,
  		      unit: unit,
  		      born_event: start,
  		      where: '',
  		      interval_count: interval
  		};
  		 
  		MP.api.retention(retention, params).done(function(results) {
          parseRetentionResults(results.values())
  		})   
		}
		
		function getInterval(){
		  intervalLength = intervalSelect.MPSelect('value');
		  var revisedIntervals = []
		  unit = unitSelect.MPSelect('value');
		  for (i = 0; i < intervalLength + 1; i++) {
          revisedIntervals.push(i + " " + unit)
      }
      return revisedIntervals
		}
		
		
		function graphChart(series_array){
      $(function () {
        $('#dataChart').highcharts({
          title: {
              text: 'Percentage Users Retained',
              x: -20 
          },
          xAxis: {
              categories: getInterval(),
              title: {
                text: 'Intervals (Days/Weeks/Months)'
              }
          },
          yAxis: {
              title: {
                  text: 'Percentage Retained (%)'
              },
              plotLines: [{
                  value: 0,
                  width: 1,
                  color: '#808080'
              }]
          },
          tooltip: {
              valueSuffix: '%'
          },
          legend: {
              layout: 'vertical',
              align: 'right',
              verticalAlign: 'middle',
              borderWidth: 0
          },
          series: series_array
        });
      });
		}

    Highcharts.theme = {
      colors: ['#2b908f', '#90ee7e', '#f45b5b', '#7798BF', '#aaeeee', '#ff0066', '#eeaaee',
          '#55BF3B', '#DF5353', '#7798BF', '#aaeeee'],
      chart: {
          backgroundColor: {
            linearGradient: { x1: 0, y1: 0, x2: 1, y2: 1 },
            stops: [
                [0, '#2a2a2b'],
                [1, '#3e3e40']
            ]
          },
          style: {
            fontFamily: '\'Unica One\', sans-serif'
          },
          plotBorderColor: '#606063'
      },
      title: {
          style: {
            color: '#E0E0E3',
            textTransform: 'uppercase',
            fontSize: '20px'
          }
      },
      subtitle: {
          style: {
            color: '#E0E0E3',
            textTransform: 'uppercase'
          }
      },
      xAxis: {
          gridLineColor: '#707073',
          labels: {
            style: {
                color: '#E0E0E3'
            }
          },
          lineColor: '#707073',
          minorGridLineColor: '#505053',
          tickColor: '#707073',
          title: {
            style: {
                color: '#A0A0A3'
    
            }
          }
      },
      yAxis: {
          gridLineColor: '#707073',
          labels: {
            style: {
                color: '#E0E0E3'
            }
          },
          lineColor: '#707073',
          minorGridLineColor: '#505053',
          tickColor: '#707073',
          tickWidth: 1,
          title: {
            style: {
                color: '#A0A0A3'
            }
          }
      },
      tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.85)',
          style: {
            color: '#F0F0F0'
          }
      },
      plotOptions: {
          series: {
            dataLabels: {
                color: '#B0B0B3'
            },
            marker: {
                lineColor: '#333'
            }
          },
          boxplot: {
            fillColor: '#505053'
          },
          candlestick: {
            lineColor: 'white'
          },
          errorbar: {
            color: 'white'
          }
      },
      legend: {
          itemStyle: {
            color: '#E0E0E3'
          },
          itemHoverStyle: {
            color: '#FFF'
          },
          itemHiddenStyle: {
            color: '#606063'
          }
      },
      credits: {
          style: {
            color: '#666'
          }
      },
      labels: {
          style: {
            color: '#707073'
          }
      },
  
      drilldown: {
          activeAxisLabelStyle: {
            color: '#F0F0F3'
          },
          activeDataLabelStyle: {
            color: '#F0F0F3'
          }
      },
    
      navigation: {
          buttonOptions: {
            symbolStroke: '#DDDDDD',
            theme: {
                fill: '#505053'
            }
          }
      },
      // scroll charts
      rangeSelector: {
          buttonTheme: {
            fill: '#505053',
            stroke: '#000000',
            style: {
                color: '#CCC'
            },
            states: {
                hover: {
                  fill: '#707073',
                  stroke: '#000000',
                  style: {
                      color: 'white'
                  }
                },
                select: {
                  fill: '#000003',
                  stroke: '#000000',
                  style: {
                      color: 'white'
                  }
                }
            }
          },
          inputBoxBorderColor: '#505053',
          inputStyle: {
            backgroundColor: '#333',
            color: 'silver'
          },
          labelStyle: {
            color: 'silver'
          }
      },
    
      navigator: {
          handles: {
            backgroundColor: '#666',
            borderColor: '#AAA'
          },
          outlineColor: '#CCC',
          maskFill: 'rgba(255,255,255,0.1)',
          series: {
            color: '#7798BF',
            lineColor: '#A6C7ED'
          },
          xAxis: {
            gridLineColor: '#505053'
          }
      },
    
      scrollbar: {
          barBackgroundColor: '#808083',
          barBorderColor: '#808083',
          buttonArrowColor: '#CCC',
          buttonBackgroundColor: '#606063',
          buttonBorderColor: '#606063',
          rifleColor: '#FFF',
          trackBackgroundColor: '#404043',
          trackBorderColor: '#404043'
      },
    
      // special colors for some of the
      legendBackgroundColor: 'rgba(0, 0, 0, 0.5)',
      background2: '#505053',
      dataLabelsColor: '#B0B0B3',
      textColor: '#C0C0C0',
      contrastTextColor: '#F0F0F3',
      maskColor: 'rgba(255,255,255,0.3)'
    };

    // Apply the theme
    Highcharts.setOptions(Highcharts.theme);
		
		// RUN CONDITIONS
		
		runQuery();
		dateSelect.on('change', function() {
		 runQuery();
		});
		startEvent.on('change', function(e, selection) {
		 runQuery();
		});
		retentionEvent.on('change', function(e, selection) {
		 runQuery();
		}); 
		intervalSelect.on('change', function(e, selection) {
		 runQuery();
		});
		unitSelect.on('change', function(e, selection) {
		$('#intervalSelect').MPSelect('initEl', getIntervalDropdownValues());
		 runQuery();
    });
    $(document).on('change', 'input[type="checkbox"]', function(e){
      runQuery();
    });
		
    </script>
  </body>
